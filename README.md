# Gmail Attachment Downloader

Gmailから特定の期間の添付ファイルを検索し、一括ダウンロードするためのGUIアプリケーションです。Flet (Python) を使用して構築されています。

## 主な機能

- **日付範囲検索**: カレンダー選択または直接入力により、特定の期間のメールを検索。
- **添付ファイルプレビュー**: 検索結果をテーブル形式で表示し、件名やファイル名を確認可能。
- **一括選択・解除**: 「すべて選択」「選択解除」ボタンによるスムーズな操作。
- **非同期処理**: 検索中やダウンロード中にUIが固まらないプログレス表示（グルグル）を実装。
- **保存先選択**: OS標準のフォルダ選択ダイアログを使用して保存先を指定可能。

## 事前準備 (Google Cloud Console)

1. [Google Cloud Console](https://console.cloud.google.com/) でプロジェクトを作成します。
2. **Gmail API** を有効化します。
3. **OAuth 同意画面**を設定します（外部/テストユーザーとして自分のメールアドレスを追加）。
4. **OAuth クライアント ID** (デスクトップアプリ) を作成し、JSONファイルを `credentials.json` という名前でプロジェクトのルートディレクトリに配置します。

## セットアップ

### 1. ライブラリのインストール
必要な依存ライブラリをインストールします。
```bash
pip install -r requirements.txt
'''

### 1. 準備
`credentials.json` をプロジェクトのルートディレクトリに配置します。

### 2. 認証（トークンの生成）
以下のコマンドを実行してブラウザでログインし、`token.pickle` を生成します。
```bash
python get_token.py
```

### 3. メイン処理の実行
認証完了後、以下のコマンドでメールの取得と添付ファイルの保存が行えます。
```bash
python main.py
```
## 操作の流れ

1. 検索: 開始日・終了日を入力（カレンダーアイコンをクリック）して「検索開始」を押します。
2. 選択: ダウンロードしたいファイルにチェックを入れます。「すべて選択」機能も利用可能です。
3. 確認: 「確認画面へ」を押し、保存先フォルダを選択してから「はい」をクリックして実行します。